<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet 
	xmlns:cps="cpsframework"
	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
	xmlns:xs="http://www.w3.org/2001/XMLSchema" 
	xmlns:fn="http://www.w3.org/2005/xpath-functions" 
	xmlns:math="http://www.w3.org/2005/xpath-functions/math" 
	xmlns:array="http://www.w3.org/2005/xpath-functions/array" 
	xmlns:map="http://www.w3.org/2005/xpath-functions/map" 
	xmlns:xhtml="http://www.w3.org/1999/xhtml" 
	xmlns:err="http://www.w3.org/2005/xqt-errors" 
	exclude-result-prefixes="array fn map math xhtml xs err" 
	version="1.0">
	
	<xsl:output method="html" version="4.0" encoding="UTF-8" omit-xml-declaration="yes"/>
	
	<xsl:template match="/" name="initial-template">
		<html xmlns="http://www.w3.org/1999/xhtml">
			<head>
				<meta name="generator" content="HTML Tidy for Windows (vers 14 October 2008), see www.w3.org"/>
				<meta http-equiv="Content-Type" content="text/html; charset=us-ascii"/>
				<meta name="Generator" content="Microsoft Word 14 (filtered)"/>
				<style type="text/css">
					/*<![CDATA[*/
					<!--
					 /* Font Definitions */
					 @font-face
							{font-family:Cambria;
							panose-1:2 4 5 3 5 4 6 3 2 4;}
					@font-face
							{font-family:Tahoma;
							panose-1:2 11 6 4 3 5 4 4 2 4;}
					@font-face
							{font-family:"Arial Narrow";
							panose-1:2 11 6 6 2 2 2 3 2 4;}
					 /* Style Definitions */
					 p.MsoNormal, li.MsoNormal, div.MsoNormal
							{margin:0in;
							margin-bottom:.0001pt;
							text-align:justify;
							font-size:10.0pt;
							font-family:"Arial","sans-serif";
							letter-spacing:.4pt;}
					h1
							{mso-style-link:"Heading 1 Char";
							margin-top:24.0pt;
							margin-right:0in;
							margin-bottom:0in;
							margin-left:0in;
							margin-bottom:.0001pt;
							text-align:justify;
							page-break-after:avoid;
							font-size:14.0pt;
							font-family:"Cambria","serif";
							color:#365F91;
							letter-spacing:.4pt;}
					h2
							{mso-style-link:"Heading 2 Char";
							margin-top:10.0pt;
							margin-right:0in;
							margin-bottom:0in;
							margin-left:0in;
							margin-bottom:.0001pt;
							text-align:justify;
							page-break-after:avoid;
							font-size:13.0pt;
							font-family:"Cambria","serif";
							color:#4F81BD;
							letter-spacing:.4pt;}
					p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
							{mso-style-link:"Body Text Char";
							margin-top:0in;
							margin-right:0in;
							margin-bottom:6.0pt;
							margin-left:0in;
							text-align:justify;
							font-size:10.0pt;
							font-family:"Arial","sans-serif";
							letter-spacing:.4pt;}
					p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
							{mso-style-link:"Document Map Char";
							margin:0in;
							margin-bottom:.0001pt;
							text-align:justify;
							font-size:8.0pt;
							font-family:"Tahoma","sans-serif";
							letter-spacing:.4pt;}
					p.TableHeading, li.TableHeading, div.TableHeading
							{mso-style-name:TableHeading;
							mso-style-link:"TableHeading Char";
							margin:0in;
							margin-bottom:.0001pt;
							font-size:10.0pt;
							font-family:"Arial","sans-serif";
							color:#002060;
							letter-spacing:.4pt;
							font-weight:bold;
							font-style:italic;}
					span.TableHeadingDetail
							{mso-style-name:TableHeadingDetail;
							font-family:"Arial Narrow","sans-serif";
							color:navy;
							font-weight:normal;
							font-style:italic;}
					span.DocumentMapChar
							{mso-style-name:"Document Map Char";
							mso-style-link:"Document Map";
							font-family:"Tahoma","sans-serif";
							letter-spacing:.4pt;}
					span.Heading2Char
							{mso-style-name:"Heading 2 Char";
							mso-style-link:"Heading 2";
							font-family:"Cambria","serif";
							color:#4F81BD;
							letter-spacing:.4pt;
							font-weight:bold;}
					span.Heading1Char
							{mso-style-name:"Heading 1 Char";
							mso-style-link:"Heading 1";
							font-family:"Cambria","serif";
							color:#365F91;
							letter-spacing:.4pt;
							font-weight:bold;}
					span.BodyTextChar
							{mso-style-name:"Body Text Char";
							mso-style-link:"Body Text";
							font-family:"Arial","sans-serif";
							letter-spacing:.4pt;}
					span.TableHeadingChar
							{mso-style-name:"TableHeading Char";
							mso-style-link:TableHeading;
							font-family:"Arial","sans-serif";
							color:#002060;
							letter-spacing:.4pt;
							font-weight:bold;
							font-style:italic;}
					.MsoChpDefault
							{font-family:"Calibri","sans-serif";}
					.MsoPapDefault
							{margin-bottom:10.0pt;
							line-height:115%;}
					@page WordSection1
							{size:11.0in 8.5in;
							margin:1.0in 1.0in 1.0in 1.0in;}
					div.WordSection1
							{page:WordSection1;}
					-->
					/*]]>*/
				</style>
				<!--<title></title>-->
				<xsl:text disable-output-escaping="yes">&lt;title&gt;&lt;/title&gt;</xsl:text>
			</head>
			<body>
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">0       Description of the Business Case</span>
				</h1>			
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:10.75pt">
						<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">ID</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Domain(s)</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Description</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Type</span>
							</p>
						</td>
					</tr>
					
					<xsl:apply-templates select="cps:CPSFramework/BusinessCase"/>
					
				</table>
			
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">1       Description of the Use Case</span>
				</h1>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.1    Name of Use Case</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:10.75pt">
						<td width="100%" colspan="3" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Use Case Identification</span>
							</p>
						</td>
					</tr>
					<tr style="height:10.75pt">
						<td width="7%" valign="top" style="width:7.58%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">ID</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20.36%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Domain(s)</span>
							</p>
						</td>
						<td width="72%" valign="top" style="width:72.06%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name of Use Case</span>
							</p>
						</td>
					</tr>
					
					<xsl:apply-templates select="cps:CPSFramework/UseCase"/>
					
				</table>
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.2    Version Management</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:1.0pt">
						<td width="100%" colspan="7" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Version Management</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="10%" valign="top" style="width:10%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Version Management Changes</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Date</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name<br/>Author(s)  or Committee</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Approval Status</span>
							</p>
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">draft, for comments, for voting, final</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Version Number</span>
							</p>
						</td>
					</tr>
					
					<xsl:apply-templates select="cps:CPSFramework/UseCase/Version"/>
					
				</table>
				
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none;margin-top:16px">
					<tr>
						<td width="100%" colspan="5" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Maturity</span>
							</p>
						</td>
					</tr>
					<tr>
						<td  width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Effective</span>
							</p>						
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Maturity</span>
							</p>	
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Responsible Party</span>
							</p>	
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Revision</span>
							</p>	
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Status</span>
							</p>	
						</td>
					</tr>
					
					<xsl:apply-templates select="cps:CPSFramework/Maturity"/>
					
				</table>
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.3    Scope and Objectives of Use Case</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:17.2pt">
						<td width="100%" colspan="2" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:17.2pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Scope and Objectives of Use Case</span>
							</p>
						</td>
					</tr>
					
					<xsl:call-template name="ScopeAndObjectives"/>
					
				</table>
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.4    Narrative of Use Case</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:1.0pt">
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Narrative of Use Case</span>
							</p>
						</td>
					</tr>

					<xsl:apply-templates select="cps:CPSFramework/UseCase/Narrative"/>					
					
				</table>
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.5    General Remarks</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">General Remarks</span>
							</p>
						</td>
					</tr>

					<xsl:apply-templates select="cps:CPSFramework/UseCase/Remark"/>

				</table>
				
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">2       Diagrams of Use Case</span>
				</h1>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#BFBFBF;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Diagram of Use Case</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<xsl:apply-templates select="/cps:CPSFramework/UseCase/Drawing"/>
						</td>
					</tr>
				</table>
				
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">3       Technical Details</span>
				</h1>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.1    Actors: People, Systems, Applications, Databases, the Power System, and Other Stakeholders</span>
				</h2>
				
				<xsl:apply-templates select="cps:CPSFramework/UseCase/CPSGrouping"/>
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.2    Preconditions, Assumptions, Post condition, Events</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="4" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Use Case Conditions</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="32%" valign="top" style="width:32.8%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Actor/System/Information/Contract</span>
							</p>
						</td>
						<td width="17%" valign="top" style="width:17.8%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Triggering Event</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15.94%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Pre-conditions</span>
							</p>
						</td>
						<td width="33%" valign="top" style="width:33.46%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Assumption</span>
							</p>
						</td>
					</tr>
					
					<xsl:call-template name="PrecoditionsAndAssumptions"/>
					
				</table>
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.3    References / Issues</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="8" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">References</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="5%" valign="top" style="width:5%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">No.</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">References Type</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Reference</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Description</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Status</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Impact on Use Case</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Originator / Organisation</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Link</span>
							</p>
						</td>
					</tr>
						
					<xsl:apply-templates select="cps:CPSFramework/UseCase/Reference"/>
					
				</table>				
				
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.4    Further Information to the Use Case for Classification / Mapping</span>
				</h2>				
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">				
					<tr>
						<td width="100%" colspan="6" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Classification Information</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="10%" valign="top" style="width:10%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Relation to Other Use Cases</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Level of Depth</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Prioritisation</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Generic, Regional or National Relation</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">View</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Further Keywords  for Classification</span>
							</p>
						</td>
					</tr>
					
					<xsl:call-template name="FurtherInformation"/>
					
				</table>
				
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">4       Step by Step Analysis of Use Case</span>
				</h1>
				
				<xsl:apply-templates select="cps:CPSFramework/UseCase/Scenario"/>
				
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">5       Information Exchanged</span>
				</h1>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="5" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Information Maturity</span>
							</p>
						</td>
					</tr>
					<tr>
						<td  width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Effective</span>
							</p>						
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Maturity</span>
							</p>	
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Responsible Party</span>
							</p>	
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Revision</span>
							</p>	
						</td>
						<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Status</span>
							</p>	
						</td>
					</tr>
					
					<xsl:apply-templates select="cps:CPSFramework/InformationModelLibrary/Maturity"/>
					
				</table>
				
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none;margin-top:16px">
					<tr>
						<td width="100%" colspan="3" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Information Exchanged</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="19%" valign="top" style="width:19.74%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name of Information Exchanged</span>
							</p>
						</td>
						<td width="44%" valign="top" style="width:44.66%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Description of Information Exchanged</span>
							</p>
						</td>
						<td width="35%" valign="top" style="width:35.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Requirements to information data</span>
							</p>
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">R-ID</span>
							</p>
						</td>
					</tr>
					
					<xsl:apply-templates select="cps:CPSFramework/InformationModelLibrary/InformationModel"/>
					
				</table>
				
			</body>
		</html>
	</xsl:template>
	
	<!--This template outputs information related to a BusinessCases.
		This includes the technicalId, identifier, name, description, type, and Domains.-->
	<xsl:template match="BusinessCase">
		<tr style="height:11.8pt">
			<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<p class="MsoNormal">
					<!--LOOKUP: BusinessCase/technicalId-->
					<xsl:attribute name="id">
						<xsl:value-of select="technicalId"/>
					</xsl:attribute>
					
					<!--LOOKUP: BusinessCase/identifier-->
					<xsl:value-of select="identifier"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				
				<p class="MsoNormal">
					<!--LOOKUP: BusinessCase/name-->
					<xsl:value-of select="name"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<xsl:for-each select="Domain">
					<p class="MsoNormal">
						<!--LOOKUP: BusinessCase/Domain/technicalId-->
						<xsl:attribute name="id">
							<xsl:value-of select="technicalId"/>
						</xsl:attribute>
						
						<!--LOOKUP: BusinessCase/Domain/name-->
						<xsl:value-of select="name"/>
					</p>
				</xsl:for-each>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<p class="MsoNormal">
					<!--LOOKUP: BusinessCase/Domain/description-->
					<xsl:value-of select="description"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<p class="MsoNormal">
					<!--LOOKUP: BusinessCase/Domain/type-->
					<xsl:value-of select="type"/>
				</p>
			</td>
		</tr>
	</xsl:template>
	
	<!--This template outputs basic information related to the UseCase. 
		This includes the technicalId, identifier, and name.-->
	<xsl:template match="UseCase">
		<tr style="height:11.8pt">
			<td width="7%" valign="top" style="width:7.58%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/technicalId-->
					<xsl:attribute name="id">
						<xsl:value-of select="technicalId"/>
					</xsl:attribute>
					
					<!--LOOKUP: UseCase/Identifier-->
					<xsl:value-of select="identifier"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20.36%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<p class="MsoNormal">
					<span lang="EN-GB" xml:lang="EN-GB">
						<!-- FIXME:
						<xsl:value-of select="/n1:CPSFramework/BusinessCase/Domain/name"/>
						<xsl:for-each select="/n1:CPSFramework/UseCase/AdditionalDomain">
							<xsl:text>, </xsl:text>
							<xsl:value-of select="name"/>
						</xsl:for-each>-->
					</span>
				</p>
			</td>
			<td width="72%" valign="top" style="width:72.06%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/name-->
					<xsl:value-of select="name"/>
				</p>
			</td>
		</tr>
	</xsl:template>
	
	<!--This is a named template that outputs the scope and objectives for a UseCase.
		It is in a push configuration because the basic information template already consumes the UseCase once.-->
	<xsl:template name="ScopeAndObjectives">
		<xsl:for-each select="cps:CPSFramework/UseCase">
			<tr>
				<td width="24%" valign="top" style="width:24.14%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Related business case</span>
					</p>
				</td>
				<td width="75%" valign="top" style="width:75.86%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/BusinessCase/technicalId-->
						<xsl:call-template name="StringJoin">
							<xsl:with-param name="values" select="BusinessCase/technicalId"/>
							<xsl:with-param name="joinString" select="', '"/>
						</xsl:call-template>
					</p>
				</td>
			</tr>
			<tr>
				<td width="24%" valign="top" style="width:24.14%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Scope</span>
					</p>
				</td>
				<td width="75%" valign="top" style="width:75.86%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/Scope-->
						<xsl:value-of select="scope"/>
					</p>
				</td>
			</tr>
			<tr>
				<td width="24%" valign="top" style="width:24.14%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Objective</span>
					</p>
				</td>
				<td width="75%" valign="top" style="width:75.86%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<xsl:for-each select="RelatedObjective">
						<p class="MsoNormal">
							<xsl:attribute name="id">
								<xsl:value-of select="technicalId"/>
							</xsl:attribute>
							<xsl:value-of select="concat(name,': ', description)"/>
						</p>
					</xsl:for-each>
				</td>
			</tr>
		</xsl:for-each>
	</xsl:template>
	
	<!--This template outputs Remarks with it's technicalId and content.-->
	<xsl:template match="Remark">
		<tr>
			<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/technicalId-->
					<xsl:attribute name="id">
						<xsl:value-of select="technicalId"/>
					</xsl:attribute>
					
					<!--LOOKUP: UseCase/Remark/content-->
					<xsl:value-of select="content"/>
				</p>
			</td>
		</tr>
	</xsl:template>
	
	<!--This template outputs Version informatoin. Multiple authors are joined by ', '.-->
	<xsl:template match="Version">
		<tr>
			<td width="10%" valign="top" style="width:10%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Version/changes-->
					<xsl:value-of select="changes"/>
				</p>
			</td>
			<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Version/date-->
					<xsl:value-of select="date"/>
				</p>
			</td>
			<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: "UseCase/Version/Author/name"
						multiple names are join with a ', '.-->
					<xsl:call-template name="StringJoin">
						<xsl:with-param name="values" select="Author/name"/>
						<xsl:with-param name="joinString" select="', '"/>
					</xsl:call-template>
				</p>
			</td>
			<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Version/approvalStatus-->
					<xsl:value-of select="approvalStatus"/>
				</p>
			</td>
			<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Version/versionNumber-->
					<xsl:value-of select="versionNumber"/>
				</p>
			</td>
		</tr>
	</xsl:template>
	
	<!--This template adds a rows to the 1.4 table for any Narrative elements.-->
	<xsl:template match="Narrative">
		<tr style="height:1.0pt">
			<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
				<p class="TableHeading">
					<span lang="EN-GB" xml:lang="EN-GB">Short description - max 3 sentences</span>
				</p>
			</td>
		</tr>
		<tr style="height:1.0pt">
			<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Narrative/shortDescription-->
					<xsl:value-of select="shortDescription"/>
				</p>
			</td>
		</tr>
		<tr style="height:1.0pt">
			<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
				<p class="TableHeading">
					<span lang="EN-GB" xml:lang="EN-GB">Complete description</span>
				</p>
			</td>
		</tr>				
		<tr style="height:1.0pt">
			<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Narrative/completeDescription-->
					<xsl:value-of select="completeDescription"/>
				</p>
			</td>
		</tr>
	</xsl:template>

	<!--Create table for basic CPSGrouping and call template for any CPS elements.-->
	<xsl:template match="CPSGrouping">
		<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
			<tr>
				<td width="100%" colspan="4" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Actors</span>
					</p>
				</td>
			</tr>
			<tr>
				<td width="42%" colspan="2" valign="top" style="width:42.98%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Grouping (Community)</span>
					</p>
				</td>
				<td width="57%" colspan="2" valign="top" style="width:57.02%;border-top:none; border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Group Description</span>
					</p>
				</td>
			</tr>
			<tr>
				<td width="42%" colspan="2" valign="top" style="width:42.98%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/CPSGrouping/identifier-->
						<xsl:attribute name="id">
							<xsl:value-of select="technicalId"/>
						</xsl:attribute>
					
						<!--LOOKUP: UseCase/CPSGrouping/name-->
						<xsl:value-of select="name"/>
					</p>
				</td>
				<td width="57%" colspan="2" valign="top" style="width:57.02%;border-top:none; border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/CPSGrouping/description-->
						<xsl:value-of select="description"/>
					</p>
				</td>
			</tr>
			<tr>
				<td width="22%" valign="top" style="width:22.26%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Actor Name</span>
					</p>
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">see Actor  List</span>
					</p>
				</td>
				<td width="20%" valign="top" style="width:20.72%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Actor Type</span>
					</p>
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">see Actor  List</span>
					</p>
				</td>
				<td width="56%" valign="top" style="width:56.7%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Further information specific to this Use Case</span>
					</p>
				</td>
			</tr>
			
			<xsl:apply-templates select="CPS"/>

		</table>
	</xsl:template>
	
	<!--Output information for CPS element-->
	<xsl:template match="CPS">
		<tr>
			<td width="22%" valign="top" style="width:22.26%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: CPSGrouping/CPS/name-->
					<xsl:value-of select="name"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20.72%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: CPSGrouping/CPS/technicalId-->
					<xsl:value-of select="technicalId"/>
				</p>
			</td>
			<td width="56%" valign="top" style="width:56.7%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: CPSGrouping/CPS/furtherInformation-->
					<xsl:value-of select="furtherInformation"/>
				</p>
			</td>
		</tr>
	</xsl:template>
	
	<!--Output UseCase Preconditino and Assumption elements.-->
	<xsl:template name="PrecoditionsAndAssumptions">
		<tr>
			<td width="32%" style="width:32.8%;border:solid windowtext 1.0pt;border-top: none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: Prerequisite/name-->
					<xsl:value-of select="cps:CPSFramework/UseCase/Prerequisite/name"/>
				</p>
			</td>
			<td width="33%" valign="top" style="width:33.46%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<xsl:for-each select="cps:CPSFramework/UseCase/Assumption">
					<p class="MsoNormal">
						<!--LOOKUP: Assumption/name & Assumpiton/content-->
						<xsl:value-of select="name"/>
						<xsl:text>: </xsl:text>
						<xsl:value-of select="content"/>
					</p>
				</xsl:for-each>
			</td>
		</tr>
	</xsl:template>
	
	<!--Output UseCase Reference element.-->
	<xsl:template match="Reference">
		<tr>
			<td width="5%" valign="top" style="width:5%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/technicalId-->
					<xsl:attribute name="id">
						<xsl:value-of select="technicalId"/>
					</xsl:attribute>
					
					<!--LOOKUP: UseCase/Reference/identifier-->
					<xsl:value-of select="identifier"/>
				</p>
			</td>
			<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/type-->
					<xsl:value-of select="type"/>
				</p>
			</td>
			<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/name-->
					<xsl:value-of select="name"/>
				</p>
			</td>
			<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/description-->
					<xsl:value-of select="description"/>
				</p>
			</td>
			<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/status-->
					<xsl:value-of select="status"/>
				</p>
			</td>
			<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/impact-->
					<xsl:value-of select="impact"/>
				</p>
			</td>
			<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/orginiatorOrganisation-->
					<xsl:value-of select="originatorOrganisation"/>
				</p>
			</td>
			<td width="15%" valign="top" style="width:15%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: UseCase/Reference/link-->
					<xsl:value-of select="link"/>
				</p>
			</td>
		</tr>
	</xsl:template>

	<!--Ouptut additional UseCase information such as RelatedUseCase, levelOfdepth, classification, etc.-->
	<xsl:template name="FurtherInformation">
		<xsl:for-each select="cps:CPSFramework/UseCase">
			<tr>
				<td width="10%" valign="top" style="width:10%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
					<!--LOOKUP: UseCase/technicalId-->
					<xsl:attribute name="id">
						<xsl:value-of select="technicalId"/>
					</xsl:attribute>
					
					<xsl:for-each select="RelatedUseCase">
						<p class="MsoNormal">
							<!--LOOKUP: UseCase/RelatedUseCase/technicalId-->
							<xsl:attribute name="id">
								<xsl:value-of select="technicalId"/>
							</xsl:attribute>
					
							<!--LOOKUP: UseCase/RelatedUseCase/name-->
							<!--<xsl:value-of select="if (position() = last()) then name else concat(name, ',')"/>-->
							<xsl:value-of select="name"/>
							<xsl:if test="position() = last()">
								<xsl:text>, </xsl:text>
							</xsl:if>
						</p>
					</xsl:for-each>
				</td>
				<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/levelOfDepth-->
						<xsl:value-of select="levelOfDepth"/>
					</p>
				</td>
				<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/prioritisation-->
						<xsl:value-of select="prioritisation"/>
					</p>
				</td>
				<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/classification-->
						<xsl:value-of select="classification"/>
					</p>
				</td>
				<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/nature-->
						<xsl:value-of select="nature"/>
					</p>
				</td>
				<td width="10%" valign="top" style="width:10%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/keywords-->
						<xsl:value-of select="keywords"/>
					</p>
				</td>
			</tr>
		</xsl:for-each>
	</xsl:template>

	<!--Output header table for a Scenario. This includes basic information about the Scenario and
		then creates sub tables for the MacroActivities and steps in this Scenario.-->
	<xsl:template match="Scenario">
		<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none;margin-top: 16px">
			<tr style="height:14.35pt">
				<td width="100%" colspan="6" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt;height:14.35pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Scenario Conditions</span>
					</p>
				</td>
			</tr>
			<tr>
				<td width="6%" valign="top" style="width:6.04%;border:solid windowtext 1.0pt; border-top:none;background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">No.</span>
					</p>
				</td>
				<td width="16%" valign="top" style="width:16.82%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Scenario Name</span>
					</p>
				</td>
				<td width="19%" valign="top" style="width:19.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Primary Actor</span>
					</p>
				</td>
				<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Triggering Event</span>
					</p>
				</td>
				<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Pre-Condition</span>
					</p>
				</td>
				<td width="16%" valign="top" style="width:16.34%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
					<p class="TableHeading">
						<span lang="EN-GB" xml:lang="EN-GB">Post-Condition</span>
					</p>
				</td>
			</tr>	
			<tr>
				<td width="6%" valign="top" style="width:6.04%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/Scenario/technicalId-->
						<xsl:attribute name="id">
							<xsl:value-of select="technicalId"/>
						</xsl:attribute>
						
						<!--LOOKUP: UseCase/Scenario/identifier-->
						<xsl:value-of select="identifier"/>
					</p>
				</td>
				<td width="16%" valign="top" style="width:16.82%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/Scenario/name-->
						<xsl:value-of select="name"/>
					</p>
				</td>
				<td width="19%" valign="top" style="width:19.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<p class="MsoNormal">
						<!--LOOKUP: UseCase/Scenario/PrimaryCPS-->
						<xsl:for-each select="PrimaryCPS">
							<p class="MsoNormal">
								<!--LOOKUP: PrimaryCPS/technicalId-->
								<xsl:attribute name="id">
									<xsl:value-of select="technicalId"/>
								</xsl:attribute>
								
								<!--LOOKUP: PrimaryCPS/name-->
								<xsl:value-of select="name"/>
							</p>
						</xsl:for-each>
					</p>
				</td>
				<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<!--LOOKUP: UseCase/Scenario/TriggeringEvent-->
					<xsl:for-each select="TriggeringEvent">
						<p class="MsoNormal">
							<!--LOOKUP: TriggeringEvent/name & TriggeringEvent/content-->
							<xsl:value-of select="concat(name, ': ', content)"/>
						</p>
					</xsl:for-each>
				</td>
				<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<!--LOOKUP: UseCase/Scenario/Precondition-->
					<xsl:for-each select="Precondition">
						<p class="MsoNormal">
							<!--LOOKUP: Precondition/name & Precondition/description-->
							<xsl:value-of select="concat(name, ': ', content)"/>
						</p>
					</xsl:for-each>
				</td>
				<td width="16%" valign="top" style="width:16.34%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
					<!--LOOKUP: UseCase/Scenario/Postcondition-->
					<xsl:for-each select="Postcondition">
						<p class="MsoNormal">
							<!--LOOKUP: Postcondition/name & Postcondition/description-->
							<xsl:value-of select="concat(name, ': ', content)"/>
						</p>
					</xsl:for-each>
				</td>
			</tr>
		</table>
		
		<xsl:apply-templates select="MacroActivity"/>
		
	</xsl:template>
	
	<!--Ouptut sub tables for a MacroActivity.-->
	<xsl:template match="MacroActivity">
		<h2>
			<span lang="EN-GB" xml:lang="EN-GB">
				<p>
					<xsl:text>MacroActivity - </xsl:text>
					<xsl:value-of select="name"/>
				</p>
			</span>
		</h2>
		
		<xsl:if test="Drawing">
			<!--LOOKUP: MacroActivity/Step/Drawing-->
			<xsl:apply-templates select="Drawing"/>
		</xsl:if>
		
		<xsl:apply-templates select="Step"/>
		
	</xsl:template>
	
	<!--Output table for a Step-->
	<xsl:template match="Step">
		<h2>
			<span lang="EN-GB" xml:lang="EN-GB">
				<p>
					<xsl:text>Steps - </xsl:text>
					<xsl:value-of select="name"/>
				</p>
			</span>
		</h2>
		<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse">
			<!--If there are any drawing a new row is inserted to contain the drawings for this step-->
			<xsl:if test="Drawing">
				<tr>
					<td width="6%" colspan="9" valign="top" style="width:6.04%;border:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt">
						<!--LOOKUP: MacroActivity/Step/Drawing-->
						<xsl:apply-templates select="Drawing"/>
					</td>
				</tr>
			</xsl:if>
			
			<tr style="height:9.2pt">
				<td width="6%" valign="top" style="width:6.48%;border:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<p class="MsoNormal">
						<!--LOOKUP: MacroActivity/Step/identifier-->
						<xsl:value-of select="identifier"/>
					</p>
				</td>
				<td width="7%" valign="top" style="width:7.44%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<p class="MsoNormal">
						<!--LOOKUP: MacroActivity/Step/event-->
						<xsl:value-of select="event"/>
					</p>
				</td>
				<td width="12%" valign="top" style="width:12.1%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<p class="MsoNormal">
						<!--LOOKUP: MacroActivity/Step/name-->
						<xsl:value-of select="name"/>
					</p>
				</td>
				<td width="13%" valign="top" style="width:13.38%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<p class="MsoNormal">
						<!--LOOKUP: MacroActivity/Step/description-->
						<xsl:value-of select="description"/>
					</p>
				</td>
				<td width="9%" valign="top" style="width:9.82%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<p class="MsoNormal">
						<!--LOOKUP: MacroActivity/Step/service-->
						<xsl:value-of select="service"/>
					</p>
				</td>
				<td width="12%" valign="top" style="width:12.32%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<xsl:for-each select="InformationProducer">
						<p class="MsoNormal">
							<!--LOOKUP: MacroActivity/Step/InformationProducer/technicalId-->
							<xsl:attribute name="id">
								<xsl:value-of select="technicalId"/>
							</xsl:attribute>
											
							<!--LOOKUP: MacroActivity/Step/InformationProducer/name-->
							<xsl:value-of select="name"/>
						</p>
					</xsl:for-each>
				</td>
				<td width="12%" valign="top" style="width:12.66%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<xsl:for-each select="InformationReceiver">
						<p class="MsoNormal">
							<!--LOOKUP: MacroActivity/Step/InformationReceiver/technicalId-->
							<xsl:attribute name="id">
								<xsl:value-of select="technicalId"/>
							</xsl:attribute>
					
							<!--LOOKUP: MacroActivity/Step/InformatoinReceiver/name-->
							<xsl:value-of select="name"/>
						</p>
					</xsl:for-each>
				</td>
				<td width="13%" valign="top" style="width:13.34%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<xsl:for-each select="BusinessObject">
						<p class="MsoNormal">
							<!--LOOKUP: MacroActivity/Step/BusinessObject/technicalId-->
							<xsl:attribute name="id">
								<xsl:value-of select="technicalId"/>
							</xsl:attribute>
					
							<!--LOOKUP: MacroActivity/Step/BusinessObject/name-->
							<xsl:value-of select="name"/>
						</p>
					</xsl:for-each>
				</td>
				<td width="12%" valign="top" style="width:12.5%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
					<xsl:for-each select="Requirement">
						<p class="MsoNormal">	
							<!--LOOKUP: MacroActivity/Step/Requirement/technicalId-->
							<xsl:value-of select="technicalId"/>
						</p>
					</xsl:for-each>
				</td>
			</tr>
		</table>
	</xsl:template>

	<!--Output InformationModel information.-->
	<xsl:template match="InformationModel">
		<tr>
			<td width="19%" valign="top" style="width:19.74%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: InformationModel/technicalId-->
					<xsl:attribute name="id">
						<xsl:value-of select="technicalId"/>
					</xsl:attribute>
				
					<!--LOOKUP: InformationModel/name-->
					<xsl:value-of select="name"/>
				</p>
			</td>
			<td width="44%" valign="top" style="width:44.66%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: InformationModel/description-->
					<xsl:value-of select="description"/>
				</p>
			</td>
			<td width="35%" valign="top" style="width:35.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: InformationModel/Requirement-->
					<xsl:call-template name="StringJoin">
						<xsl:with-param name="values" select="Requirement/technicalId"/>
						<xsl:with-param name="joinString" select="', '"/>
					</xsl:call-template>
				</p>
			</td>
		</tr>
	</xsl:template>
	
	<!--Creates a table for a Maturity element. This will output all the information in a table row.-->
	<xsl:template match="Maturity">
		<tr>
			<td width="20%" valign="top" style="width:20%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: Maturity/effective-->
					<xsl:value-of select="effective"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: Maturity/maurity-->
					<xsl:value-of select="maturity"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: Maturity/responsibleParty-->
					<xsl:value-of select="responsibleParty"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: Maturity/revision-->
					<xsl:value-of select="revision"/>
				</p>
			</td>
			<td width="20%" valign="top" style="width:20%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
				<p class="MsoNormal">
					<!--LOOKUP: Maturity/status-->
					<xsl:value-of select="status"/>
				</p>
			</td>
		</tr>
	</xsl:template>

	<!--Outputs a Drawing as an html img element. Images will be placed on their own lines
		use a p element.-->
	<xsl:template match="Drawing">
		<p>
			<xsl:element name="img">
				<xsl:attribute name="id">
					<xsl:value-of select="drawingType"/>
				</xsl:attribute>
				<xsl:attribute name="width">
					<xsl:value-of select="substring-before(substring-after(URI,'W'),'_')"/>
				</xsl:attribute>
				<xsl:attribute name="height">
					<xsl:value-of select="substring-before(substring-after(URI,'H'),'_')"/>
					</xsl:attribute>
				<xsl:attribute name="src">
					<xsl:value-of select="URI"/>
				</xsl:attribute>
				<xsl:attribute name="alt">
					<xsl:value-of select="name"/>
				</xsl:attribute>
			</xsl:element>
		</p>
	</xsl:template>

	<xsl:template name="StringJoin">
		<xsl:param name="values"/>
		<xsl:param name="joinString"/>
		<xsl:for-each select="$values">
			<xsl:value-of select="."/>
			<xsl:if test="position() &lt; last()">
				<xsl:value-of select="$joinString"/>
			</xsl:if>
		</xsl:for-each>
	</xsl:template>

</xsl:stylesheet>
